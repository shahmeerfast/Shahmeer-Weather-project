<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.js"></script>
    <link rel="stylesheet" href="index.css">
  
</head>
<body class="bg-gray-100">
    <div class="flex flex-col md:flex-row h-screen">
        
        <div class="w-full md:w-64 bg-white shadow-lg">
            
            <div class="p-4">
                
                <img src="logo.png" alt="Logo" class="w-32 h-auto mx-auto mb-4">
                <h1 class="text-xl font-bold text-center">Weather App</h1>
            </div>

    
            <div id="profilePreview" class="px-4 py-2 border-b">
                <div class="flex items-center space-x-3">
                    <img id="avatarPreview" src="1.jpg" alt="Profile" class="w-8 h-8 rounded-full">
                    <span id="usernamePreview" class="text-sm font-medium">Guest User</span>
                </div>
            </div>
            <nav class="mt-4">
                <a href="#" class="block px-4 py-2 text-gray-600 hover:bg-gray-100" data-section="dashboard">Dashboard</a>
                <a href="#" class="block px-4 py-2 text-gray-600 hover:bg-gray-100" data-section="tables">Tables</a>
                <a href="#" class="block px-4 py-2 text-gray-600 hover:bg-gray-100" data-section="profile">Profile</a>
            </nav>
        </div>

    
        <div class="flex-1 p-4 md:p-8 overflow-y-auto">
            
            <div class="flex flex-col md:flex-row justify-between items-center mb-8">
                <div class="flex-1 w-full md:max-w-xl">
                    <input type="text" id="citySearch" placeholder="Enter city name..." 
                           class="w-full px-4 py-2 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-400">
                </div>
                <div class="mt-4 md:mt-0 md:ml-4">
                    <button id="searchButton" class="w-full md:w-auto px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                        Search
                    </button>
                </div>
                <div class="mt-4 md:mt-0 md:ml-4 w-full md:w-auto">
                    <select id="unitToggle" class="w-full md:w-auto px-4 py-2 rounded-lg border">
                        <option value="metric">Celsius</option>
                        <option value="imperial">Fahrenheit</option>
                    </select>
                </div>
            </div>

            
            <div id="dashboardSection" class="section active">
            
                <div id="weatherWidget" class="weather-widget p-8 rounded-xl text-white mb-8 slide-in">
                    <div id="weatherInfo" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div>
                            <h2 id="cityName" class="text-3xl font-bold mb-4">--</h2>
                            <p id="temperature" class="text-5xl font-bold mb-4">--째</p>
                            <p id="description" class="text-xl mb-2">--</p>
                        </div>
                        <div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <p class="text-sm opacity-75">Humidity</p>
                                    <p id="humidity" class="text-xl font-bold">--%</p>
                                </div>
                                <div>
                                    <p class="text-sm opacity-75">Wind Speed</p>
                                    <p id="windSpeed" class="text-xl font-bold">-- m/s</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-8">
                    <div class="bg-white p-4 rounded-xl shadow">
                        <canvas id="tempBarChart" class="w-full h-full"></canvas>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow">
                        <canvas id="weatherDoughnutChart" class="w-full h-full"></canvas>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow">
                        <canvas id="tempLineChart" class="w-full h-full"></canvas>
                    </div>
                </div>

            
                <div class="bg-white rounded-xl shadow p-4">
                    <div class="flex flex-col h-auto md:h-auto lg:h-auto">
                        <div id="chatMessages" class="flex-1 overflow-y-auto mb-4 p-4 bg-gray-50 rounded min-h-[200px]">
                        </div>
                        <div class="flex gap-2">
                            <input type="text" id="chatInput" placeholder="Ask about weather or anything else..." 
                                   class="flex-1 px-4 py-2 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-400">
                            <button id="sendMessage" class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                                Send
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            
            <div id="tablesSection" class="section">
                <div class="bg-white rounded-xl shadow p-6">
                    <h2 class="text-2xl font-bold mb-4">Weather Forecast Details</h2>
                    <div class="overflow-x-auto">
                        <table class="min-w-full table-auto">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="px-4 py-2 text-left">Date</th>
                                    <th class="px-4 py-2 text-left">Time</th>
                                    <th class="px-4 py-2 text-left">Temperature</th>
                                    <th class="px-4 py-2 text-left">Weather</th>
                                    <th class="px-4 py-2 text-left">Humidity</th>
                                    <th class="px-4 py-2 text-left">Wind Speed</th>
                                    <th class="px-4 py-2 text-left">Pressure</th>
                                </tr>
                            </thead>
                            <tbody id="weatherTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            
            <div id="profileSection" class="section">
                <div class="max-w-2xl mx-auto">
                    <div class="bg-white rounded-xl shadow p-6">
                        <h2 class="text-2xl font-bold mb-6">User Profile</h2>
                        
                        <div class="mb-8 text-center">
                            <img id="profileAvatar" src="1.jpg" alt="Profile Picture" class="w-32 h-32 rounded-full mx-auto mb-4 profile-avatar">
                            <button id="changeAvatarBtn" class="text-blue-500 hover:text-blue-600">Change Avatar</button>
                        </div>

                        <form id="profileForm" class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>
                                <input type="text" id="username" class="w-full px-4 py-2 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-400">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                                <input type="email" id="email" class="w-full px-4 py-2 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-400">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Default City</label>
                                <input type="text" id="defaultCity" class="w-full px-4 py-2 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-400">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Temperature Unit</label>
                                <select id="defaultUnit" class="w-full px-4 py-2 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-400">
                                    <option value="metric">Celsius</option>
                                    <option value="imperial">Fahrenheit</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700">Theme Preference</label>
                                <div class="mt-2 space-x-4">
                                    <label class="inline-flex items-center">
                                        <input type="radio" name="theme" value="light" class="form-radio" checked>
                                        <span class="ml-2">Light</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="radio" name="theme" value="dark" class="form-radio">
                                        <span class="ml-2">Dark</span>
                                    </label>
                                </div>
                            </div>

                            <button type="submit" class="w-full px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                                Save Changes
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_KEY = '69acf068a558d0120e4ce7a9f71bb4df';
        const GEMINI_API_KEY = 'AIzaSyBwFchHNMo_9OyasOUfY0AnUfR5V-z4WvM';

        let barChart, doughnutChart, lineChart;
        let currentWeatherData = null;

        function initCharts() {
            const barCtx = document.getElementById('tempBarChart').getContext('2d');
            barChart = new Chart(barCtx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: '5-Day Temperature',
                        data: [],
                        backgroundColor: 'rgba(54, 162, 235, 0.5)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    animation: {
                        delay: (context) => context.dataIndex * 100
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            const doughnutCtx = document.getElementById('weatherDoughnutChart').getContext('2d');
            doughnutChart = new Chart(doughnutCtx, {
                type: 'doughnut',
                data: {
                    labels: [],
                    datasets: [{
                        data: [],
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.5)',
                            'rgba(54, 162, 235, 0.5)',
                            'rgba(255, 206, 86, 0.5)',
                            'rgba(75, 192, 192, 0.5)'
                        ]
                    }]
                },
                options: {
                    animation: {
                        delay: (context) => context.dataIndex * 100
                    }
                }
            });

            const lineCtx = document.getElementById('tempLineChart').getContext('2d');
            lineChart = new Chart(lineCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Temperature Trend',
                        data: [],
                        borderColor: 'rgba(75, 192, 192, 1)',
                        tension: 0.4
                    }]
                },
                options: {
                    animation: {
                        y: {
                            duration: 2000,
                            easing: 'easeOutBounce'
                        }
                    }
                }
            });
        }

        async function fetchWeatherData(city) {
            try {
                const units = document.getElementById('unitToggle').value;
                
                const currentResponse = await fetch(
                    `https://api.openweathermap.org/data/2.5/weather?q=${city}&units=${units}&appid=${API_KEY}`
                );
                const currentData = await currentResponse.json();

                const forecastResponse = await fetch(
                    `https://api.openweathermap.org/data/2.5/forecast?q=${city}&units=${units}&appid=${API_KEY}`
                );
                const forecastData = await forecastResponse.json();

                currentWeatherData = currentData;
                updateWeatherDisplay(currentData);
                updateCharts(forecastData);
                updateWeatherTable(forecastData);
            } catch (error) {
                console.error('Error fetching weather data:', error);
                
                document.getElementById('cityName').textContent = 'City not found';
            }
        }

        function updateWeatherDisplay(data) {
            document.getElementById('cityName').textContent = `${data.name}, ${data.sys.country}`;
            document.getElementById('temperature').textContent = `${Math.round(data.main.temp)}째`;
            document.getElementById('description').textContent = data.weather[0].description;
            document.getElementById('humidity').textContent = `${data.main.humidity}%`;
            document.getElementById('windSpeed').textContent = `${data.wind.speed} m/s`;

            
            const weatherWidget = document.getElementById('weatherWidget');
            weatherWidget.classList.remove('clear', 'clouds', 'rain');
            if (data.weather[0].main.toLowerCase().includes('clear')) {
                weatherWidget.classList.add('clear');
            } else if (data.weather[0].main.toLowerCase().includes('cloud')) {
                weatherWidget.classList.add('clouds');
            } else {
                weatherWidget.classList.add('rain');
            }
        }

        function updateCharts(forecastData) {
            // Bar Chart
            const temperatures = forecastData.list.slice(0, 5).map(item => item.main.temp);
            const dates = forecastData.list.slice(0, 5).map(item => 
                new Date(item.dt * 1000).toLocaleDateString()
            );

            barChart.data.labels = dates;
            barChart.data.datasets[0].data = temperatures;
            barChart.update();

            //  Doughnut Chart
            const weatherTypes = {};
            forecastData.list.forEach(item => {
                const type = item.weather[0].main;
                weatherTypes[type] = (weatherTypes[type] || 0) + 1;
            });

            doughnutChart.data.labels = Object.keys(weatherTypes);
            doughnutChart.data.datasets[0].data = Object.values(weatherTypes);
            doughnutChart.update();

            // Line Chart
            const hourlyTemps = forecastData.list.slice(0, 8).map(item => item.main.temp);
            const hours = forecastData.list.slice(0, 8).map(item => 
                new Date(item.dt * 1000).toLocaleTimeString([], { hour: '2-digit' })
            );

            lineChart.data.labels = hours;
            lineChart.data.datasets[0].data = hourlyTemps;
            lineChart.update();
        }

        function updateWeatherTable(forecastData) {
            const tableBody = document.getElementById('weatherTableBody');
            tableBody.innerHTML = '';

            forecastData.list.forEach(item => {
                const row = document.createElement('tr');
                const date = new Date(item.dt * 1000);
                
                row.innerHTML = `
                    <td class="px-4 py-2">${date.toLocaleDateString()}</td>
                    <td class="px-4 py-2">${date.toLocaleTimeString()}</td>
                    <td class="px-4 py-2">${Math.round(item.main.temp)}째</td>
                    <td class="px-4 py-2">${item.weather[0].description}</td>
                    <td class="px-4 py-2">${item.main.humidity}%</td>
                    <td class="px-4 py-2">${item.wind.speed} m/s</td>
                    <td class="px-4 py-2">${item.main.pressure} hPa</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Chat functionality
        async function handleChat(message) {
            const chatMessages = document.getElementById('chatMessages');
            
        
            const userDiv = document.createElement('div');
            userDiv.className = 'mb-2';
            userDiv.innerHTML = `<p class="bg-blue-100 p-2 rounded inline-block">You: ${message}</p>`;
            chatMessages.appendChild(userDiv);

            try {
                const weatherContext = currentWeatherData ? 
                    `Current weather in ${currentWeatherData.name}: ${currentWeatherData.main.temp}째, ${currentWeatherData.weather[0].description}` :
                    'No weather data available';

                const response = await fetch(
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`,
                    {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: `Context: ${weatherContext}\nUser: ${message}\nProvide a helpful response about the weather or related topic.`
                                }]
                            }]
                        })
                    }
                );

                const data = await response.json();
                const botResponse = data.candidates[0].content.parts[0].text;

                const botDiv = document.createElement('div');
                botDiv.className = 'mb-2';
                botDiv.innerHTML = `<p class="bg-gray-100 p-2 rounded inline-block">Assistant: ${botResponse}</p>`;
                chatMessages.appendChild(botDiv);

            } catch (error) {
                console.error('Chat error:', error);
                const errorDiv = document.createElement('div');
                errorDiv.className = 'mb-2';
                errorDiv.innerHTML = `<p class="bg-red-100 p-2 rounded inline-block">Error: Could not get response</p>`;
                chatMessages.appendChild(errorDiv);
            }

            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            initCharts();
            
            
            document.querySelectorAll('[data-section]').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = link.getAttribute('data-section');
                    document.querySelectorAll('.section').forEach(section => {
                        section.classList.remove('active');
                    });
                    document.getElementById(`${sectionId}Section`).classList.add('active');
                });
            });

            // Search
            document.getElementById('searchButton').addEventListener('click', () => {
                const city = document.getElementById('citySearch').value;
                if (city) {
                    fetchWeatherData(city);
                }
            });

            // Chat
            document.getElementById('sendMessage').addEventListener('click', () => {
                const input = document.getElementById('chatInput');
                if (input.value.trim()) {
                    handleChat(input.value);
                    input.value = '';
                }
            });

            document.getElementById('chatInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && e.target.value.trim()) {
                    handleChat(e.target.value);
                    e.target.value = '';
                }
            });

            // Profile Form
            document.getElementById('profileForm').addEventListener('submit', (e) => {
                e.preventDefault();
                
                const formData = {
                    username: document.getElementById('username').value,
                    email: document.getElementById('email').value,
                    defaultCity: document.getElementById('defaultCity').value,
                    defaultUnit: document.getElementById('defaultUnit').value,
                    theme: document.querySelector('input[name="theme"]:checked').value
                };
                
                
                if (formData.theme === 'dark') {
                    document.body.classList.add('dark-mode');
                } else {
                    document.body.classList.remove('dark-mode');
                }

                
                document.getElementById('usernamePreview').textContent = formData.username;
                
                
                console.log('Profile updated:', formData);
            });

            
            fetchWeatherData('London');
        });
    </script>
</body>
</html>
